<style type="text/css" media="screen">
  body {
    background: #FDFCE9;
  }
</style>

<script type="text/javascript" charset="utf-8">
var errors = [];
window.onerror = onError;
addEvent(window, 'load', load);

// Set focus to this iframe
this.focus();
code = parent.codeToRun;

try {
  document.write(code);
} catch(e) {
  alert(e.message);
}


function addEvent(a,b,c,d) {
  if (a.addEventListener) {
    a.addEventListener(b,c,d?true:false);
  } else if(a.attachEvent) {
    a.attachEvent('on'+b,c);
  } else{
    a['on'+b]=c;
  }
}

function load() {
  var first = document.getElementsByTagName('body')[0].childNodes[0];
  for (var i=0; i < errors.length; i++) {
    document.body.insertBefore(errors[i], first);
  }
}

function Stack() { try { throw Error() } catch(ex) { return ex.stack } }

function onError(msg, href, lineNo) {
  var errorDiv = document.createElement('div');
  errorDiv.style.textAlign = 'center';
  errorDiv.style.fontWeight = 'bold';
  errorDiv.style.fontSize = '92%';
  errorDiv.style.width = '100%';
  errorDiv.style.padding = '0.5em 0';
  var html = [];

  var lastSlash = href.lastIndexOf("/");
  var fileName = lastSlash == -1 ? href : href.substr(lastSlash+1);

  html.push(
    '<span style="display: inline-block;background: #ffd363 url(images/tl.gif) top left no-repeat;">',
    '<span style="background: url(images/bl.gif) bottom left no-repeat;">',
    '<span style="background: url(images/tr.gif) top right no-repeat;">',
    '<span style="background: url(images/br.gif) bottom right no-repeat;">',
    '<span style="background: transparent;padding: 0.2em 2em;color: #ce0c0c">',
    'Error: ' + msg,
    '</span>',
    '</span>',
    '</span>',
    '</span>',
    '</span>'
  );
  errorDiv.innerHTML = html.join('\n');

  // In some firefox's, the body tag isn't loaded so we can't print the error.
  // We have to wait until the body tag loads, then we print.
  // In other firefox's, the body loads before errors are fired, so we can add
  // immediately
  var first = document.getElementsByTagName('body')[0];
  if (first && first.childNodes) {
    first = first.childNodes[0];
    document.body.insertBefore(errorDiv, first);
  } else {
    errors.push(errorDiv);
  }
};

</script>